---
title: "Basic Results"
author: "Wenyi Lin"
date: "October 13, 2016"
output: html_document
---

```{r}
library(dplyr)
folder<-"/Users/wendylin/Documents/AD/data/FARS2015NationalCSV/"
main.data<-read.csv(paste0(folder,"accident.csv"))
sup.data<-read.csv(paste0(folder,"vehicle.csv"))
sup.data.norepli<-sup.data[!duplicated(sup.data$ST_CASE),]
useful.data<-cbind(main.data$STATE,main.data$ST_CASE,main.data$RUR_URB,
                  main.data$FUNC_SYS,main.data$TYP_INT,main.data$REL_ROAD,
                  sup.data.norepli$VTRAFWAY,sup.data.norepli$VNUM_LAN,
                  main.data$FATALS,main.data$CITY,main.data$COUNTY,
                  main.data$LATITUDE,main.data$LONGITUD,main.data$HOUR)
colnames(useful.data)<-c("STATE","ST_CASE","RUR_URB","FUNC_SYS","TYP_INT",
                     "REL_ROAD","VTRAFWAY","VNUM_LAN","FATALS","CITY","COUNTY",
                     "LATITUDE","LONGITUD","HOUR")
fatality<-data.frame(useful.data)
maryland.fatality<-fatality[fatality$STATE==24,]

map<-get_map("maryland",maptype = "roadmap")
func<-as.factor(maryland.fatality$FUNC_SYS)
levels(func)<-c("Interstate","Principal_Arterial_free_exp","Principal Arterial_other",
                "Minor_Arterial","Major_Collector","Minor_Collector","Local",
                "Unknown1","Unknown2","Unknown3")
maryland.fatality$func<-func

#functional system effect
ggmap(map) + geom_point(
  aes(x=LONGITUD, y=LATITUDE, show_guide = TRUE,
      colour=func,fill=func), 
  data=maryland.fatality, na.rm = T)

#rural & urban
rural_urban<-as.factor(maryland.fatality$RUR_URB)
maryland.fatality$rural_urban<-rural_urban
ggmap(map) + geom_point(
  aes(x=LONGITUD, y=LATITUDE, show_guide = TRUE,
      colour=rural_urban,fill=rural_urban), 
  data=maryland.fatality, na.rm = T)

#save(useful.data,file=paste0(folder,"useful.RData"))
```

